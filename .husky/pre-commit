#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# å‰ç«¯ä»£ç æ£€æŸ¥
echo "ğŸ” Running Flutter code analysis..."
flutter analyze --fatal-infos --fatal-warnings

echo "ğŸ¨ Checking Flutter code formatting..."
dart format --output=none --set-exit-if-changed .

echo "ğŸ§ª Running Flutter tests..."
flutter test

# åç«¯ä»£ç æ£€æŸ¥ï¼ˆå¦‚æœå­˜åœ¨åç«¯æ›´æ”¹ï¼‰
if [ -d "../åç«¯/eteria-backend" ]; then
  echo "ğŸ” Running backend linting..."
  cd ../åç«¯/eteria-backend
  npm run lint
  
  echo "ğŸ¨ Checking backend code formatting..."
  npm run format:check
  
  echo "ğŸ§ª Running backend tests..."
  npm run test:ci
  cd -
fi

echo "âœ… Pre-commit checks passed!"